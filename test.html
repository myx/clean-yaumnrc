<html>
	<head>
		<script>
			var module = { export : {} };
		</script>
		<script src="index.js"></script>
		<script>
			function test(){
				var Config = module.exports;
				var config = Config.parse({
					"locations" : {
						"h1" : {
							"name" : "h1.myx.ru",
							"wan3" : "5.9.15.205"
						},
						"h2" : {
							"name" : "h2.myx.ru",
							"wan3" : "5.9.100.81"
						},
						"g1" : {
							"name" : "g1.myx.ru"
						}
					},
					"servers" : {
						"l6h1.myx.ru" : {
							"router" : "active",
							"location" : "h1"
						},
						"ae3.myx.ru" : {
							"location" : "h1"
						}
					}
				});
				
				var output = document.getElementById('output');
				function out(t,x){
					var d = document.createElement('div');
					d.innerHTML = t + ": <pre>" + x + "</pre>";
					output.appendChild(d);
				}
				
				out('Config', config);
				out('Locations', config.locations);
				out('Servers', config.servers);
				out('Routers', config.routers);
				
				var viewL = config.makeView('h1');
				
				out('Config', viewL);
				out('Location', viewL.location);
				out('Location.Servers', viewL.location.servers);
				out('Location.Routers', viewL.location.routers);

				var viewR = config.makeView('g1');
				
				out('Config', viewR);
				out('Location', viewR.location);
				out('Location.Servers', viewR.location.servers);
				out('Location.Routers', viewR.location.routers);

				var viewS = config.makeView('l6h1.myx.ru');
				
				out('Config', viewS);
				out('Location', viewS.location);
				out('Server', viewS.server);
				out('Router', viewS.router);

				out('Location.Servers', viewS.location.servers);
				out('Location.Routers', viewS.location.routers);
				
				
				out('Config.Source', config.toSource());

			}
		</script>
	</head>
	<body onload="test()">
		<div id="output">
		</div>
	</body>
</html>